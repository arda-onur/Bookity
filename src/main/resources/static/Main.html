<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="main.css">
    <title>Main Page</title>
</head>
<header>
    <div id="headerdiv">
        <p id="BookityLabel"> Bookity </p>
    </div>
</header>
<body>
<div id="menubuttons">
    <button id="searchbutton">Search</button>
    <input name="productSearch" placeholder="" id="productSearch">
    <select name="select" id="select">
        <option value="NAME">NAME</option>
        <option value="CATEGORY">CATEGORY</option>
        <option value="ISBN">ISBN</option>
    </select>
</div>

<div id="windowlabel">
    <p>ISBN</p>
    <p>CATEGORY</p>
    <p>NAME</p>
</div>
<div id="pagination">
    <button id="prevButton" type="button">Previous</button>
    <button id="nextButton" type="button">Next</button>
</div>
<div id="bodywindow">
</div>


<script>
    var currentPage = 1;
    var itemsPerPage = 10;
    var productList ;

    function search(extension) {
        var xhr = new XMLHttpRequest();
        var url = "http://localhost:8080/book/"+extension;

        xhr.open("GET", url);
        xhr.setRequestHeader("Content-Type", "application/json");
        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4) {
                if (xhr.status == 200) {
                    productList = JSON.parse(xhr.responseText);
                    // Clear previous results
                    document.getElementById("bodywindow").innerHTML = "";
                    console.log(productList);
                    console.log(url)
                    // Display books for the current page
                    var startIndex = (currentPage - 1) * itemsPerPage;
                    var endIndex = Math.min(startIndex + itemsPerPage, productList.length);
                    for (var i = startIndex; i < endIndex; i++) {
                        var book = productList[i];
                        var productInfo = document.createElement('div');
                        var empty=document.createElement('div2');
                        var img=document.createElement('img');
                         img.height =50;
                         img.width =30;
                         img.src = book.imageUrl;
                        productInfo.innerHTML = "&emsp;&emsp;&emsp;&emsp;"
                            + book.isbn
                            + "&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;" +
                            book.category +
                            "&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;"
                            + book.bookname;
                        productInfo.appendChild(img);
                        empty.innerHTML ="--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------";
                        document.getElementById("bodywindow").appendChild(productInfo);
                        document.getElementById("bodywindow").appendChild(empty);
                    }

                }
            }
        };

        xhr.send();
    }
    var extention ="getbooks";
    var content ="productSearch"
    var cat ="select"
    document.getElementById("searchbutton").addEventListener("click", function () {
         currentPage = 1;
         content= document.getElementById("productSearch").value;
         cat = document.getElementById("select").value;
         extention = "search?input="+content+"&category="+cat;
         console.log(content,cat);
        search(extention);
    });

    document.getElementById("prevButton").addEventListener("click", function () {
        if (currentPage > 1) {
            currentPage--;
            search(extention);
        }
    });

    document.getElementById("nextButton").addEventListener("click", function () {

        if(currentPage >= (productList.length)/itemsPerPage){
        }else{
            currentPage++;
            search(extention);
        }
    });

    // Initial search on page load
    window.onload = function () {
        search(extention);
    };
    console.log(productList);
</script>
</body>
</html>